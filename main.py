import asyncio
import csv
import os
from playwright.async_api import async_playwright

LIST =['https://www.facebook.com/vishalkumar02003/', 'https://www.facebook.com/vlinstituteofnursery/', 'https://www.facebook.com/volume.net.in/', 'https://www.facebook.com/vowtecommerce/', 'https://www.facebook.com/walkinvimannagar/', 'https://www.facebook.com/wallpointwallcoverings/', 'https://www.facebook.com/walstartechnologies/', 'https://www.facebook.com/webamplifier/', 'https://www.facebook.com/webfairindia/', 'https://www.facebook.com/weddingsbyneeraj/', 'https://www.facebook.com/weddingsbyrishabh/', 'https://www.facebook.com/wedknotstoriesofficial/', 'https://www.facebook.com/wedmin.in/', 'https://www.facebook.com/welcometosaad/', 'https://www.facebook.com/wellness-462985670233625/', 'https://www.facebook.com/wellnessviberiveshvade/', 'https://www.facebook.com/wevaphotography/', 'https://www.facebook.com/whileloops.tech/', 'https://www.facebook.com/whitepagerealty/', 'https://www.facebook.com/wilwin.ielts/', 'https://www.facebook.com/xcodersofficial/', 'https://www.facebook.com/yash.dhanesha.5/', 'https://www.facebook.com/yogabratachakrabortyframemaker/', 'https://www.facebook.com/yrdesignandconstruction/', 'https://www.facebook.com/yuvasadecor/', 'https://www.facebook.com/yuvnarealty/', 'https://www.facebook.com/zplusphotography-170838676117093/', 'https://www.facebook.com/ztirealty/', 'https://facebook.com/61572887939109', 'https://facebook.com/aliijazbuttarofficial', 'https://facebook.com/immigrationlawyerny', 'https://facebook.com/sonai.chatterjee.528', 'https://www.facebook.com/100003897430291/', 'https://www.facebook.com/100049634293335/', 'https://www.facebook.com/100050155704155/', 'https://www.facebook.com/100054620341747/', 'https://www.facebook.com/100057053006110/', 'https://www.facebook.com/100057210529286/', 'https://www.facebook.com/100063488352872/', 'https://www.facebook.com/100063662781498/', 'https://www.facebook.com/100063788771168/', 'https://www.facebook.com/100063818054974/', 'https://www.facebook.com/100063836507056/', 'https://www.facebook.com/100063911748788/', 'https://www.facebook.com/100063940990042/', 'https://www.facebook.com/100063961657042/', 'https://www.facebook.com/100063981937946/', 'https://www.facebook.com/100064028470161/', 'https://www.facebook.com/100064042243092/', 'https://www.facebook.com/100064043772746/', 'https://www.facebook.com/100064070530712/', 'https://www.facebook.com/100064089127257/', 'https://www.facebook.com/100064117353721/', 'https://www.facebook.com/100064567213956/', 'https://www.facebook.com/100064588006928/', 'https://www.facebook.com/100064792503784/', 'https://www.facebook.com/100067473105251/', 'https://www.facebook.com/100068638890049/', 'https://www.facebook.com/100069656752217/', 'https://www.facebook.com/100070470518746/', 'https://www.facebook.com/100070597098143/', 'https://www.facebook.com/100070685550469/', 'https://www.facebook.com/100075452067760/', 'https://www.facebook.com/100075797397443/', 'https://www.facebook.com/100075969977986/', 'https://www.facebook.com/100076359255576/', 'https://www.facebook.com/100076535260124/', 'https://www.facebook.com/100076646447721/', 'https://www.facebook.com/100080673013426/', 'https://www.facebook.com/100080755684184/', 'https://www.facebook.com/100082318796961/', 'https://www.facebook.com/100082716378132/', 'https://www.facebook.com/100083114243289/', 'https://www.facebook.com/100083150171691/', 'https://www.facebook.com/100083168026960/', 'https://www.facebook.com/100083178468273/', 'https://www.facebook.com/100083179328968/', 'https://www.facebook.com/100083199561229/', 'https://www.facebook.com/100083345211118/', 'https://www.facebook.com/100083437684783/', 'https://www.facebook.com/100083576197715/', 'https://www.facebook.com/100083683983628/', 'https://www.facebook.com/100083923640183/', 'https://www.facebook.com/100084183003149/', 'https://www.facebook.com/100084215422871/', 'https://www.facebook.com/100084266954081/', 'https://www.facebook.com/100084423413189/', 'https://www.facebook.com/100085355270159/', 'https://www.facebook.com/100085612444406/', 'https://www.facebook.com/100086263753701/', 'https://www.facebook.com/100086745850436/', 'https://www.facebook.com/100086847206757/', 'https://www.facebook.com/100087382059945/', 'https://www.facebook.com/100087401351955/', 'https://www.facebook.com/100087596138217/', 'https://www.facebook.com/100087891802679/', 'https://www.facebook.com/100088054214778/', 'https://www.facebook.com/100088072031334/', 'https://www.facebook.com/100088138485074/', 'https://www.facebook.com/100088511194119/', 'https://www.facebook.com/100088557698449/', 'https://www.facebook.com/100088779791566/', 'https://www.facebook.com/100088838357555/', 'https://www.facebook.com/100089632504940/', 'https://www.facebook.com/100089805115656/', 'https://www.facebook.com/100089919495333/', 'https://www.facebook.com/100089982190325/', 'https://www.facebook.com/100090168322073/', 'https://www.facebook.com/100090227444463/', 'https://www.facebook.com/100090367638165/', 'https://www.facebook.com/100090400856809/', 'https://www.facebook.com/100090889254022/', 'https://www.facebook.com/100091061635500/', 'https://www.facebook.com/100091266203730/', 'https://www.facebook.com/100091494557049/', 'https://www.facebook.com/100091630900218/', 'https://www.facebook.com/100091647878049/', 'https://www.facebook.com/100091869744952/', 'https://www.facebook.com/100092296877089/', 'https://www.facebook.com/100092676013179/', 'https://www.facebook.com/100092980535911/', 'https://www.facebook.com/100093159992121/', 'https://www.facebook.com/100094107776054/', 'https://www.facebook.com/100094121525365/', 'https://www.facebook.com/100094164400791/', 'https://www.facebook.com/100094271138476/', 'https://www.facebook.com/100094628596003/', 'https://www.facebook.com/100094805006996/', 'https://www.facebook.com/100094864006991/', 'https://www.facebook.com/100095272615593/', 'https://www.facebook.com/100095489834545/', 'https://www.facebook.com/113166621722916', 'https://www.facebook.com/360medicare.co.uk/', 'https://www.facebook.com/422473324292273', 'https://www.facebook.com/508906102635456/posts/1671884953004226/', 'https://www.facebook.com/61550066581236/', 'https://www.facebook.com/61550080895527/', 'https://www.facebook.com/61550104134542/', 'https://www.facebook.com/61550711725458/', 'https://www.facebook.com/61550823549425/', 'https://www.facebook.com/61550892163925/', 'https://www.facebook.com/61551046958457/', 'https://www.facebook.com/61551225470175/', 'https://www.facebook.com/61551652438650/', 'https://www.facebook.com/61552135234872/', 'https://www.facebook.com/61552246375234/', 'https://www.facebook.com/61552543291496/', 'https://www.facebook.com/61552619275007/', 'https://www.facebook.com/61552812849789/', 'https://www.facebook.com/61553037495588/', 'https://www.facebook.com/61553142411722/', 'https://www.facebook.com/61553195894634/', 'https://www.facebook.com/61553203298694/', 'https://www.facebook.com/61553259178327/', 'https://www.facebook.com/61553280323987/', 'https://www.facebook.com/61553285674756/', 'https://www.facebook.com/61553382547729/', 'https://www.facebook.com/61553613581764/', 'https://www.facebook.com/61553725896115/', 'https://www.facebook.com/61553785687867/', 'https://www.facebook.com/61553972073461/', 'https://www.facebook.com/61554006187200/', 'https://www.facebook.com/61554632818157/', 'https://www.facebook.com/61554787380411/', 'https://www.facebook.com/61554908669767/', 'https://www.facebook.com/61555271070775/', 'https://www.facebook.com/61555574970119/', 'https://www.facebook.com/61555748469821/', 'https://www.facebook.com/61555761864383/', 'https://www.facebook.com/61555811580727/', 'https://www.facebook.com/61555827453504/', 'https://www.facebook.com/61555912614095/', 'https://www.facebook.com/61555960911067/', 'https://www.facebook.com/61555969720187/', 'https://www.facebook.com/61556088082130/', 'https://www.facebook.com/61556364262727/', 'https://www.facebook.com/61556388603996/', 'https://www.facebook.com/61556451227238/', 'https://www.facebook.com/61556606425687/', 'https://www.facebook.com/61556728330232/', 'https://www.facebook.com/61556764381923/', 'https://www.facebook.com/61557045114483/', 'https://www.facebook.com/61557079049215/', 'https://www.facebook.com/61557141344653/', 'https://www.facebook.com/61557485154576/', 'https://www.facebook.com/61557527156770/', 'https://www.facebook.com/61557600705182/', 'https://www.facebook.com/61557615512145/', 'https://www.facebook.com/61557628646576/', 'https://www.facebook.com/61557956730859/', 'https://www.facebook.com/61558020695894/', 'https://www.facebook.com/61558088414978/', 'https://www.facebook.com/61558234805939/', 'https://www.facebook.com/61558543525370/', 'https://www.facebook.com/61558691076438/', 'https://www.facebook.com/61558819332940/', 'https://www.facebook.com/61558840262261/', 'https://www.facebook.com/61558892390905/', 'https://www.facebook.com/61558900603246/', 'https://www.facebook.com/61558939232030/', 'https://www.facebook.com/61559057915274/', 'https://www.facebook.com/61559160572353/', 'https://www.facebook.com/61559553680740/', 'https://www.facebook.com/61559735572059/', 'https://www.facebook.com/61559813247271/', 'https://www.facebook.com/61559852573584/', 'https://www.facebook.com/61560014769150/', 'https://www.facebook.com/61560190345442/', 'https://www.facebook.com/61560280270000/', 'https://www.facebook.com/61560511382232/', 'https://www.facebook.com/61560517723555/', 'https://www.facebook.com/61560575594564/', 'https://www.facebook.com/61560825009195/', 'https://www.facebook.com/61560875215816/', 'https://www.facebook.com/61560901814864/', 'https://www.facebook.com/61560929066642/', 'https://www.facebook.com/61561060343016/', 'https://www.facebook.com/61561084490185/', 'https://www.facebook.com/61561098818049/', 'https://www.facebook.com/61561168434174/', 'https://www.facebook.com/61561254260434/', 'https://www.facebook.com/61561413519884/', 'https://www.facebook.com/61561480323378/', 'https://www.facebook.com/61561483114121/', 'https://www.facebook.com/61561703849023/', 'https://www.facebook.com/61561776711081/', 'https://www.facebook.com/61561911316592/', 'https://www.facebook.com/61562038314898/', 'https://www.facebook.com/61562065737510/', 'https://www.facebook.com/61562155079331/', 'https://www.facebook.com/61562162852385/', 'https://www.facebook.com/61562262860709/', 'https://www.facebook.com/61562417325516/', 'https://www.facebook.com/61562456784546/', 'https://www.facebook.com/61562510743307/', 'https://www.facebook.com/61562719354492/', 'https://www.facebook.com/61562958263400/', 'https://www.facebook.com/61563373480599/', 'https://www.facebook.com/61563500946530/', 'https://www.facebook.com/61563853213331/', 'https://www.facebook.com/61563875425775/', 'https://www.facebook.com/61563971578457/', 'https://www.facebook.com/61564114075422/', 'https://www.facebook.com/61564310132220/', 'https://www.facebook.com/61564449116121/', 'https://www.facebook.com/61564592743198/', 'https://www.facebook.com/61564769759571/', 'https://www.facebook.com/61564814887435/', 'https://www.facebook.com/61564843575488/', 'https://www.facebook.com/61564873314880/', 'https://www.facebook.com/61565332320682/', 'https://www.facebook.com/61565408137582/', 'https://www.facebook.com/61565669207704/', 'https://www.facebook.com/61565759174041/', 'https://www.facebook.com/61565829878184/', 'https://www.facebook.com/61566136808916/', 'https://www.facebook.com/61566424035310/', 'https://www.facebook.com/61566480135913/', 'https://www.facebook.com/61566579423197/', 'https://www.facebook.com/61566619940214/', 'https://www.facebook.com/61566738386934/', 'https://www.facebook.com/61566858809392/', 'https://www.facebook.com/61566898042618/', 'https://www.facebook.com/61566904710874/', 'https://www.facebook.com/61567035907145/', 'https://www.facebook.com/61567064030540/', 'https://www.facebook.com/61567247540493/', 'https://www.facebook.com/61567277130921/', 'https://www.facebook.com/61567453647705/', 'https://www.facebook.com/61567496671797/', 'https://www.facebook.com/61567527925891/', 'https://www.facebook.com/61567658647809/', 'https://www.facebook.com/61567726797535/', 'https://www.facebook.com/61567751254799/', 'https://www.facebook.com/61567766954334/', 'https://www.facebook.com/61567809003517/', 'https://www.facebook.com/61567938296933/', 'https://www.facebook.com/61568195021392/', 'https://www.facebook.com/61568256751676/', 'https://www.facebook.com/61568473692186/', 'https://www.facebook.com/61568671468984/', 'https://www.facebook.com/61568739400655/', 'https://www.facebook.com/61569097051743/', 'https://www.facebook.com/61569154661327/', 'https://www.facebook.com/61569180195416/', 'https://www.facebook.com/61569305210915/', 'https://www.facebook.com/61569320938058/', 'https://www.facebook.com/61569350348087/', 'https://www.facebook.com/61569359487867/', 'https://www.facebook.com/61569481191273/', 'https://www.facebook.com/61569567789340/', 'https://www.facebook.com/61569635003356/', 'https://www.facebook.com/61569803948659/', 'https://www.facebook.com/61569849611402/', 'https://www.facebook.com/61569878548510/', 'https://www.facebook.com/61570018414714/', 'https://www.facebook.com/61570111015127/', 'https://www.facebook.com/61570180800986/', 'https://www.facebook.com/61570278490217/', 'https://www.facebook.com/61570279423975/', 'https://www.facebook.com/61570638827398/', 'https://www.facebook.com/61570780001660/', 'https://www.facebook.com/61570836051680/', 'https://www.facebook.com/61570839082231/', 'https://www.facebook.com/61570855776896/', 'https://www.facebook.com/61570939453355/', 'https://www.facebook.com/61570979815793/', 'https://www.facebook.com/61571026133975/', 'https://www.facebook.com/61571191426808/', 'https://www.facebook.com/61571211997688/', 'https://www.facebook.com/61571348664474/', 'https://www.facebook.com/61571455046510/', 'https://www.facebook.com/61571461979404/', 'https://www.facebook.com/61571624254666/', 'https://www.facebook.com/61571777074810/', 'https://www.facebook.com/61571859785600/', 'https://www.facebook.com/61571863035194/', 'https://www.facebook.com/61571943182178/', 'https://www.facebook.com/61572242916595/', 'https://www.facebook.com/61572352144945/', 'https://www.facebook.com/61572385988592/', 'https://www.facebook.com/61572390421705/', 'https://www.facebook.com/61572394499570/', 'https://www.facebook.com/61572427165051/', 'https://www.facebook.com/61572510689381/', 'https://www.facebook.com/61572561034109/', 'https://www.facebook.com/61572590712726/', 'https://www.facebook.com/61572719033690/', 'https://www.facebook.com/61572807724336/', 'https://www.facebook.com/61572818916769/', 'https://www.facebook.com/61572847223507/', 'https://www.facebook.com/61572878435631/', 'https://www.facebook.com/61572881881296/', 'https://www.facebook.com/61572887939109/', 'https://www.facebook.com/61572905655724/', 'https://www.facebook.com/61572927526183/', 'https://www.facebook.com/61572957721881/', 'https://www.facebook.com/61572977446712/', 'https://www.facebook.com/61573029702078/', 'https://www.facebook.com/61573052129369/', 'https://www.facebook.com/61573073232979/', 'https://www.facebook.com/61573083142493/', 'https://www.facebook.com/61573092061591/', 'https://www.facebook.com/61573134540529/', 'https://www.facebook.com/61573171420310/', 'https://www.facebook.com/61573197754746/', 'https://www.facebook.com/61573200655012/', 'https://www.facebook.com/61573283286275/', 'https://www.facebook.com/61573351156560/', 'https://www.facebook.com/61573413557852/', 'https://www.facebook.com/61573442247203/', 'https://www.facebook.com/61573496126233/', 'https://www.facebook.com/61573515731976/', 'https://www.facebook.com/61573561092516/', 'https://www.facebook.com/61573572194662/', 'https://www.facebook.com/61573633001536/', 'https://www.facebook.com/61573666455776/', 'https://www.facebook.com/61573696239435/', 'https://www.facebook.com/61573763705955/', 'https://www.facebook.com/61573828503850/', 'https://www.facebook.com/61573835774353/', 'https://www.facebook.com/61573838101827/', 'https://www.facebook.com/61573882345284/', 'https://www.facebook.com/61573924874564/', 'https://www.facebook.com/61573930712619/', 'https://www.facebook.com/61573932473913/', 'https://www.facebook.com/61573963562061/', 'https://www.facebook.com/61573999773831/', 'https://www.facebook.com/61574076513798/', 'https://www.facebook.com/61574080716811/', 'https://www.facebook.com/61574081272228/', 'https://www.facebook.com/61574086362479/', 'https://www.facebook.com/61574450040952/', 'https://www.facebook.com/61574478467160/', 'https://www.facebook.com/61574484163155/', 'https://www.facebook.com/61574496633795/', 'https://www.facebook.com/61574520941183/', 'https://www.facebook.com/61574524770966/', 'https://www.facebook.com/61574536303058/', 'https://www.facebook.com/61574567107736/', 'https://www.facebook.com/61574618272553/', 'https://www.facebook.com/61574655374998/', 'https://www.facebook.com/61574665457481/', 'https://www.facebook.com/61574685070077/', 'https://www.facebook.com/61574698127265/', 'https://www.facebook.com/61574707143759/', 'https://www.facebook.com/61574718587179/', 'https://www.facebook.com/61574784936500/', 'https://www.facebook.com/61574809046066/', 'https://www.facebook.com/61574812692825/', 'https://www.facebook.com/61574832907957/', 'https://www.facebook.com/61574841033031/', 'https://www.facebook.com/61574850036803/', 'https://www.facebook.com/61574853807812/', 'https://www.facebook.com/61574855200548/', 'https://www.facebook.com/61574856806385/', 'https://www.facebook.com/61574859010099/', 'https://www.facebook.com/61574861289505/', 'https://www.facebook.com/61574865490502/', 'https://www.facebook.com/61574878261759/', 'https://www.facebook.com/61574884262220/', 'https://www.facebook.com/61574897828904/', 'https://www.facebook.com/61574902265853/', 'https://www.facebook.com/61574905535452/', 'https://www.facebook.com/61574906124639/', 'https://www.facebook.com/61574918722982/', 'https://www.facebook.com/61574943750507/', 'https://www.facebook.com/61574955652953/', 'https://www.facebook.com/61574968111121/', 'https://www.facebook.com/61574983611485/', 'https://www.facebook.com/61575003534593/', 'https://www.facebook.com/61575004975286/', 'https://www.facebook.com/61575065069836/', 'https://www.facebook.com/61575072146690/', 'https://www.facebook.com/61575092758504/', 'https://www.facebook.com/61575097047673/', 'https://www.facebook.com/61575099655349/', 'https://www.facebook.com/61575105777570/', 'https://www.facebook.com/61575118432829/', 'https://www.facebook.com/61575123890441/', 'https://www.facebook.com/61575151136024/', 'https://www.facebook.com/61575207982463/', 'https://www.facebook.com/61575221992191/', 'https://www.facebook.com/61575253100200/', 'https://www.facebook.com/6umugam/', 'https://www.facebook.com/7squareinteriordesign/', 'https://www.facebook.com/91springboard/', 'https://www.facebook.com/AMRSumangaleeJewellers/', 'https://www.facebook.com/ANEES9941/', 'https://www.facebook.com/ATOMBEE-TALENTZ-atombeein-141188702416792/', 'https://www.facebook.com/AbhishekLegalApex/', 'https://www.facebook.com/AbhishekPalPage/', 'https://www.facebook.com/Acanthusarchitectureinteriors/', 'https://www.facebook.com/AdvanceDecorativeLaminates/', 'https://www.facebook.com/AedasDesign/', 'https://www.facebook.com/AlexxONellOfficial/', 'https://www.facebook.com/AlilaJabalAkhdar/', 'https://www.facebook.com/Ar.harkaran.boparai/', 'https://www.facebook.com/ArchitectPrashantSancheti/', 'https://www.facebook.com/ArchitectureStudentContest/', 'https://www.facebook.com/ArkadeGroup/', 'https://www.facebook.com/ArtAndArtistTattooStudio/', 'https://www.facebook.com/AsianBusinessSchool/', 'https://www.facebook.com/Baroque.d.b/', 'https://www.facebook.com/BeeTeesAcademy/', 'https://www.facebook.com/Bellaspellbyshreya/', 'https://www.facebook.com/Bharathi.Edu.Institutions/', 'https://www.facebook.com/Brandtorque/', 'https://www.facebook.com/CentricityWealthTech/', 'https://www.facebook.com/Chayadigitalagency/', 'https://www.facebook.com/CleopatraDaySpaPatiala/', 'https://www.facebook.com/CocoonFineRugs/', 'https://www.facebook.com/CraveryCafe/', 'https://www.facebook.com/Dcorasia22/', 'https://www.facebook.com/Deepak-Singh-110095212191674/', 'https://www.facebook.com/DigitalChaabiAcademy/', 'https://www.facebook.com/DigitalSupportKerala/', 'https://www.facebook.com/DolphinBusinessCentre/', 'https://www.facebook.com/DramaBoxMoviesDrama/', 'https://www.facebook.com/ESTEL.International/', 'https://www.facebook.com/EllenEllaBeautyPhilippines/', 'https://www.facebook.com/ExpertHomeopathy/', 'https://www.facebook.com/Financial-Consultant-Insurance-Advisor-171093486096436/', 'https://www.facebook.com/FinancialNirvana/', 'https://www.facebook.com/Foodzo-456634500873929/', 'https://www.facebook.com/FranchiseSahiHai/']


phone_list = set()
chunk_size = 100
semaphore = asyncio.Semaphore(8)

# Load existing numbers from CSV to prevent duplicates
if os.path.exists("phones.csv"):
    with open("phones.csv", newline="") as f:
        reader = csv.reader(f)
        phone_list.update(row[0] for row in reader)

async def process_url(browser, url):
    async with semaphore:
        page = await browser.new_page()
        try:
            await page.goto(url)
            try:
                await page.click("div[aria-label='Close']", timeout=3000)
            except:
                pass
            await page.wait_for_selector("div[role='main']")
            await page.wait_for_timeout(3000)
            phone_element = page.locator("text=/\\+?[0-9][0-9\\-\\s]{8,}/").first
            if await phone_element.count() > 0:
                raw = await phone_element.inner_text()
                cleaned = raw.replace(" ", "")
                if cleaned not in phone_list:
                    phone_list.add(cleaned)
                    with open("phones.csv", "a", newline="") as f:
                        writer = csv.writer(f)
                        writer.writerow([cleaned])
        except:
            pass
        finally:
            await page.close()
            LIST.remove(url)

async def go():
    async with async_playwright() as p:
        browser = await p.chromium.launch(headless=False)
        tasks = [process_url(browser, url) for url in LIST[:chunk_size]]
        await asyncio.gather(*tasks)
        await browser.close()

asyncio.run(go())
